<!-- base.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Mon Site Web{% endblock %}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-custom">
        <a class="navbar-brand" href="{% url 'rastaaslan_app:home' %}">Rastaaslan</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <div class="burger-icon">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'rastaaslan_app:home' %}">Accueil</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'rastaaslan_app:vods' %}">VODs</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'rastaaslan_app:clips' %}">Clips</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'rastaaslan_app:live' %}">Live</a>
                </li>
                <!-- Bouton de thème -->
                <li class="nav-item">
                    <div class="theme-toggle" id="theme-toggle" title="Changer de thème">
                        <!-- Icône de soleil (visible en mode sombre) -->
                        <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 17.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zm0 1.5a7 7 0 1 1 0-14 7 7 0 0 1 0 14zm0-16a1 1 0 0 1 1 1v1a1 1 0 0 1-2 0V4a1 1 0 0 1 1-1zm0 16a1 1 0 0 1 1 1v1a1 1 0 0 1-2 0v-1a1 1 0 0 1 1-1zM4 12a1 1 0 0 1 1-1h1a1 1 0 0 1 0 2H5a1 1 0 0 1-1-1zm16 0a1 1 0 0 1-1 1h-1a1 1 0 0 1 0-2h1a1 1 0 0 1 1 1zM6.34 6.34a1 1 0 0 1 1.42 0l.7.7a1 1 0 0 1-1.4 1.43l-.72-.7a1 1 0 0 1 0-1.43zm10.9 10.9a1 1 0 0 1 1.43 0l.7.71a1 1 0 1 1-1.42 1.42l-.7-.7a1 1 0 0 1 0-1.43zM17.66 6.34a1 1 0 0 1 0 1.43l-.7.7a1 1 0 0 1-1.43-1.42l.7-.7a1 1 0 0 1 1.43 0zm-10.9 10.9a1 1 0 0 1 0 1.43l-.71.7a1 1 0 0 1-1.42-1.42l.7-.7a1 1 0 0 1 1.43 0z"/>
                        </svg>
                        
                        <!-- Icône d'étoile/lune (visible en mode clair) -->
                        <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12.3 22h-.1a10.31 10.31 0 0 1-7.34-3.15 10.46 10.46 0 0 1-.26-14 10.13 10.13 0 0 1 4-2.74 1 1 0 0 1 1.06.22 1 1 0 0 1 .24 1 8.4 8.4 0 0 0 1.94 8.81 8.47 8.47 0 0 0 8.83 1.94 1 1 0 0 1 1.27 1.29A10.16 10.16 0 0 1 12.3 22zm-7.46-17.9a8.3 8.3 0 0 0-4.24 9.61 8.43 8.43 0 0 0 6.41 5.79 8.44 8.44 0 0 0 8.48-2.78 10.5 10.5 0 0 1-9.67-2.78A10.44 10.44 0 0 1 2.84 4.1z"/>
                        </svg>
                    </div>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container mt-4">
        {% block content %}
        <!-- Contenu dynamique ici -->
        {% endblock %}
    </div>

    {% block chat %}
    <!-- Le chat sera inclus ici si nécessaire -->
    {% endblock %}

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    
    <!-- Scripts consolidés -->
    <script>
    $(document).ready(function(){
        // Thème clair/sombre
        function setTheme(themeName) {
            document.documentElement.setAttribute('data-theme', themeName);
            localStorage.setItem('theme', themeName);
        }
        
        function toggleTheme() {
            if (localStorage.getItem('theme') === 'dark') {
                setTheme('light');
            } else {
                setTheme('dark');
            }
        }
        
        // Initialiser le thème
        if (localStorage.getItem('theme') === 'dark') {
            setTheme('dark');
        } else if (localStorage.getItem('theme') === 'light') {
            setTheme('light');
        } else {
            // Préférence système par défaut
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                setTheme('dark');
            } else {
                setTheme('light');
            }
        }
        
        // Clic sur le bouton de thème
        $('#theme-toggle').on('click', function(){
            toggleTheme();
        });
        
        // Menu hamburger animation
        $('.navbar-toggler').on('click', function(){
            var isExpanded = $(this).attr('aria-expanded') === 'true';
            
            if (isExpanded) {
                $(this).attr('aria-expanded', 'false');
            } else {
                $(this).attr('aria-expanded', 'true');
            }
        });
        
        // Fermer le menu sur mobile quand on clique sur un lien
        $('.navbar-nav a.nav-link').on('click', function(){
            $('.navbar-collapse').collapse('hide');
        });
        
        // Initialisation du carousel
        var $carousel = $('#carouselClips');
        if ($carousel.length > 0) {
            $carousel.carousel({
                interval: 5000
            });
            
            function positionCarouselItems() {
                var $items = $carousel.find('.carousel-item');
                var $active = $carousel.find('.carousel-item.active');
                
                if ($active.length === 0 || $items.length <= 1) {
                    return;
                }
                
                var activeIndex = $active.index();
                var total = $items.length;
                
                $items.removeClass('left right');
                
                var leftIndex = (activeIndex - 1 + total) % total;
                $items.eq(leftIndex).addClass('left');
                
                var rightIndex = (activeIndex + 1) % total;
                $items.eq(rightIndex).addClass('right');
            }
            
            positionCarouselItems();
            $carousel.on('slid.bs.carousel', positionCarouselItems);
        }
    });
    </script>
</body>
</html>